<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>لوحة مراجعة طلبات الشحن</title>
    <link rel="stylesheet" href="css/index.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'tajawal': ['Tajawal', 'sans-serif']
                    },
                    colors: {
                        'neon-blue': '#00d4ff',
                        'neon-purple': '#9b59ff', 
                        'neon-green': '#32ff7e',
                        'neon-pink': '#ff0080',
                        'neon-yellow': '#ffff00',
                        'neon-orange': '#ff8000',
                        'neon-cyan': '#00ffff',
                        'neon-red': '#ff0040',
                        'neon-teal': '#00ff80',
                        'neon-lime': '#80ff00',
                        'neon-indigo': '#8000ff',
                        'neon-rose': '#ff0060',
                        'bg-dark': '#0b0f14',
                        'bg-darker': '#070a0f',
                        'bg-card': 'rgba(255,255,255,0.03)',
                        'bg-card-hover': 'rgba(255,255,255,0.08)',
                        'border-neon': 'rgba(0,212,255,0.3)',
                        'shadow-neon': '0 0 20px rgba(0,212,255,0.3)',
                        'shadow-purple': '0 0 20px rgba(155,89,255,0.3)'
                    },
                    animation: {
                        'gradient-shift': 'gradientShift 3s ease-in-out infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-glow': 'pulseGlow 2s ease-in-out infinite alternate'
                    },
                    keyframes: {
                        gradientShift: {
                            '0%, 100%': { backgroundPosition: '0% 50%' },
                            '50%': { backgroundPosition: '100% 50%' }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        pulseGlow: {
                            '0%': { boxShadow: '0 0 5px rgba(0,212,255,0.5)' },
                            '100%': { boxShadow: '0 0 20px rgba(0,212,255,0.8), 0 0 30px rgba(155,89,255,0.3)' }
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
    <link rel="stylesheet" href="css/add-suggestion.css">

</head>
<body class="font-tajawal bg-gradient-to-br from-bg-darker via-bg-dark to-bg-darker text-white min-h-screen">
    <div id="sidebar-container"></div>
    
    <!-- زر إظهار/إخفاء السايد بار على الكمبيوتر فقط -->
    <button id="desktop-sidebar-toggle" style="display:none" class="hidden md:block fixed top-4 right-4 z-50 bg-gradient-to-r from-neon-purple to-neon-blue text-white px-4 py-3 rounded-xl shadow-lg hover:shadow-neon transition-all duration-300 backdrop-blur-sm" title="إظهار/إخفاء القائمة">
        <i class="fa fa-bars"></i>
    </button>
    
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-60 z-40 hidden md:hidden" style="display:none;pointer-events:none;"></div>
    
    <!-- Mobile Header -->
    <header class="sticky top-0 z-50 backdrop-blur-md bg-bg-dark/80 border-b border-white/10 p-4 flex items-center justify-between md:hidden">
        <div class="flex items-center gap-3">
            <button class="p-3 rounded-xl bg-gradient-to-r from-neon-purple/20 to-neon-blue/20 border border-neon-blue/30 hover:border-neon-blue/50 transition-all duration-300 hover:shadow-lg hover:shadow-neon-blue/20" onclick="openSidebar()">
                <i class="fa fa-bars text-lg text-neon-blue"></i>
            </button>
            <a href="#" class="text-xl font-bold bg-gradient-to-r from-neon-purple to-neon-blue bg-clip-text text-transparent">
                GamesHub Admin
            </a>
        </div>
        <div class="flex items-center gap-3">
            <a href="login.html" class="px-4 py-2 rounded-xl bg-gradient-to-r from-neon-purple/20 to-neon-blue/20 border border-white/10 hover:border-neon-blue/50 transition-all duration-300 text-sm font-medium" onclick="try{sessionStorage.setItem('post_auth_return', window.location.pathname+window.location.search+window.location.hash);}catch(e){} window.location.href='login.html'">
                <i class="fa fa-sign-out-alt ml-2"></i>
                تسجيل خروج
            </a>
        </div>
    </header>


    <div class="min-h-screen md:mr-64 relative z-10 transition-all duration-300">
        <div class="container mx-auto py-8 px-4">
            <!-- Header Section -->
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold mb-4">
                    <span class="bg-gradient-to-r from-neon-purple via-neon-blue to-neon-green bg-clip-text text-transparent">
                        <i class="fa fa-wallet ml-3"></i>
                        لوحة إدارة المحفظة
                    </span>
                </h1>
                <p class="text-white/70 text-lg">مراجعة واعتماد طلبات الشحن والسحب</p>
            </div>

            <!-- Navigation Tabs -->
            <div class="flex justify-center mb-8 gap-4 flex-wrap">
                <button id="show-topups" class="px-6 py-3 rounded-xl bg-gradient-to-r from-neon-blue to-neon-cyan text-black font-bold shadow-lg hover:shadow-neon-blue/50 transition-all duration-300 transform hover:scale-105">
                    <i class="fa fa-arrow-up ml-2"></i>
                    طلبات الشحن
                </button>
                <button id="show-withdrawals" class="px-6 py-3 rounded-xl bg-gradient-to-r from-gray-600/20 to-gray-700/20 border border-white/20 text-white font-bold hover:border-neon-purple/50 transition-all duration-300 transform hover:scale-105">
                    <i class="fa fa-arrow-down ml-2"></i>
                    طلبات السحب
                </button>
                <a href="admin_deals.html" class="px-6 py-3 rounded-xl bg-gradient-to-r from-neon-green to-neon-teal text-black font-bold shadow-lg hover:shadow-neon-green/50 transition-all duration-300 transform hover:scale-105">
                    <i class="fa fa-handshake ml-2"></i>
                    إدارة الصفقات
                </a>
            </div>

            <!-- Main Content Card -->
            <div class="bg-gradient-to-br from-bg-card via-bg-card-hover to-bg-card rounded-2xl shadow-2xl p-6 md:p-10 border border-white/10 backdrop-blur-sm max-w-7xl mx-auto">
                <div id="topups-section">
                    <h1 class="text-2xl font-bold mb-6 text-center">طلبات شحن المحفظة (مراجعة الإدارة)</h1>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white/90 rounded-xl shadow text-black">
                            <thead>
                                <tr class="bg-gray-200 text-gray-700">
                                    <th class="py-3 px-4">#</th>
                                    <th class="py-3 px-4">المستخدم</th>
                                    <th class="py-3 px-4">رقم الهاتف</th>
                                    <th class="py-3 px-4">المبلغ</th>
                                    <th class="py-3 px-4">طريقة الشحن</th>
                                    <th class="py-3 px-4">الإيصال</th>
                                    <th class="py-3 px-4">الحالة</th>
                                    <th class="py-3 px-4">الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="topups-table-body">
                                <tr><td colspan="8" class="text-center py-8 text-lg text-gray-600">جاري التحميل...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div id="withdrawals-section" style="display:none">
                    <div class="card-bg rounded-2xl shadow-lg p-6 md:p-10 border border-white/10 max-w-5xl mx-auto">
                        <h1 class="text-2xl font-bold mb-6 text-center">طلبات سحب الرصيد (مراجعة الإدارة)</h1>
                        <div class="overflow-x-auto">
                            <table class="min-w-full bg-white/90 rounded-xl shadow text-black">
                                <thead>
                                    <tr class="bg-gray-200 text-gray-700">
                                        <th class="py-3 px-4">#</th>
                                        <th class="py-3 px-4">المستخدم</th>
                                        <th class="py-3 px-4">رقم الهاتف</th>
                                        <th class="py-3 px-4">المبلغ</th>
                                        <th class="py-3 px-4">طريقة السحب</th>
                                        <th class="py-3 px-4">الحالة</th>
                                        <th class="py-3 px-4">تاريخ الطلب</th>
                                        <th class="py-3 px-4">الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="withdrawals-table-body">
                                    <tr><td colspan="8" class="text-center py-8 text-lg text-gray-600">جاري التحميل...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <!-- Modal for receipt image -->
    <div id="receipt-modal" style="display:none;position:fixed;z-index:99999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);align-items:center;justify-content:center;">
        <div style="position:relative;max-width:90vw;max-height:90vh;display:flex;align-items:center;justify-content:center;">
            <img id="receipt-modal-img" src="" alt="إيصال الشحن" style="max-width:90vw;max-height:80vh;border-radius:8px;box-shadow:0 2px 16px #0008;" />
            <button id="close-receipt-modal" style="position:absolute;top:-16px;right:-16px;background:#e63946;color:#fff;border:none;border-radius:50%;width:36px;height:36px;font-size:22px;cursor:pointer;box-shadow:0 2px 8px #0006;">&times;</button>
        </div>
    </div>
        <script src="js/admin_topups.js"></script>
        <script src="js/sidebar.js"></script>
        <script>
            // زر إظهار/إخفاء السايد بار على الكمبيوتر
                        document.addEventListener('DOMContentLoaded', function() {
                                var btn = document.getElementById('desktop-sidebar-toggle');
                                // إظهار الزر فقط إذا كان المستخدم أدمن
                                fetch('api/get_user.php', { credentials: 'include' })
                                    .then(async res => {
                                        try { return await res.json(); } catch { return {}; }
                                    })
                                    .then(userData => {
                                        if (userData && userData.profile && userData.profile.role === 'admin') {
                                            btn && (btn.style.display = 'block');
                                        }
                                    });
                                btn && btn.addEventListener('click', function() {
                                        var trySidebar = function() {
                                                var sidebar = document.getElementById('sidebar');
                                                if (sidebar) {
                                                        sidebar.classList.toggle('translate-x-full');
                                                } else {
                                                        setTimeout(trySidebar, 100);
                                                }
                                        };
                                        trySidebar();
                                });
                        });
                        document.getElementById('show-topups').onclick = function() {
    document.getElementById('topups-section').style.display = '';
    document.getElementById('withdrawals-section').style.display = 'none';
    this.classList.add('bg-blue-500','text-white');
    document.getElementById('show-withdrawals').classList.remove('bg-blue-500','text-white');
    document.getElementById('show-withdrawals').classList.add('bg-gray-300','text-black');
};
document.getElementById('show-withdrawals').onclick = function() {
    document.getElementById('topups-section').style.display = 'none';
    document.getElementById('withdrawals-section').style.display = '';
    this.classList.add('bg-blue-500','text-white');
    document.getElementById('show-topups').classList.remove('bg-blue-500','text-white');
    document.getElementById('show-topups').classList.add('bg-gray-300','text-black');
};
        </script>
</body>
</html>
